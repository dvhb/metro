angular.module("dvhbSubwayMap",[]),function(t){"use strict";function n(){function n(n,i,e,o,a){function s(){c.resolve(),t.forEach(u,function(t,i){f[t]=f[t]||{},f[t].isDisabled=n.stations?!r(n.stations,t):!0})}function r(n,i){return t.isArray(n)?-1!=n.indexOf(i):t.isObject(n)?t.isDefined(n[i]):!1}var u,c,c=a.defer(),l=this,f={};n.subwayInfo=null,u=e[0].querySelectorAll("[subway-station-name]"),u=[].map.call(u,function(t){return t.attributes["subway-station-name"].nodeValue}),s(),l.setSubwayInfo=function(t){n.subwayInfo=t},l.onSelectStation=function(i,e){(n.subwayInfo.show||t.noop)(e),(n.onSelect||t.noop)(i,e)},l.findStation=function(n){var i=f[n];return t.isDefined(i)?i:{}},n.$watch("stations",s,!0)}function i(t,n,i){}return n.$inject=["$scope","$http","$element","$attrs","$q"],{restrict:"AE",replace:!1,transclude:!0,controller:n,controllerAs:"subwayMap",link:i,templateUrl:function(t,n){return n.mapUrl||"./metro.svg"},scope:{stations:"=?",onSelect:"=?"}}}t.module("dvhbSubwayMap").directive("subwayMap",n)}(angular),function(t){"use strict";function n(){function t(t,n,i,e){function o(){for(var t,i,e=n.find("circle"),o=e.length-1;o>=0;o--)if(e[o].classList.contains("subway-point")){t=e[o],i=t.getBoundingClientRect();break}return i?{left:i.left,top:i.top+window.scrollY}:null}function a(n){t.data.isDisabled||(n.fromStation=!0,u.onSelectStation([r],o())),!t.data.isDisabled&&u.multiple&&(t.data.isActive=!t.data.isActive)}function s(){r=i.subwayStationName,n.bind("click",a);var e=u.findStation(r);e&&(t.data=e,c&&c.registerStation(r,e),t.$watch("data.isDisabled",function(t){n[0].classList.toggle("disabled",t)}))}var r,u=e[1],c=e[0];s()}return{require:["?^subwayStationGroup","^subwayMap"],restrict:"A",link:t,scope:{}}}t.module("dvhbSubwayMap").directive("subwayStationName",n)}(angular),function(t){"use strict";function n(){function n(n,i,e,o){function a(n){return t.extend(n,c)}function s(t){var e=t.left,o=t.top;n.offset&&n.offset.left&&(e+=n.offset.left||0),n.offset&&n.offset.top&&(o+=n.offset.top||0),i.css("left",e+"px"),i.css("top",o+"px"),i.css("display","block")}function r(){i.css("display","none")}function u(){i.css("position","absolute"),r(),l.setSubwayInfo(a({},c)),n.control&&a(n.control)}var c,l=o[0];c={show:s,hide:r},u()}return{require:["^subwayMap"],restrict:"A",link:n,scope:{control:"=?",offset:"=?"}}}t.module("dvhbSubwayMap").directive("subwayInfo",n)}(angular),function(t){"use strict";function n(){function n(t,n){t.stations={},t.main="",this.registerStation=function(n,i){t.stations[n]=i,t.main=n}}function i(n,i,e,o){function a(){var i=!0;return t.forEach(n.stations,function(t,n){t.isDisabled===!1&&(i=!1)}),i}n.$watch(a,function(t){i[0].classList.toggle("disabled",t)}),i.find("text").bind("click",function(t){var i=[];if(!a()){for(var e in n.stations)e.isDisabled||i.push(e);t.originalEvent.fromStation=!0;var s=$(t.target).position();o.onSelectStation(i,s)}})}return n.$inject=["$scope","$element"],{restrict:"A",link:i,require:"^subwayMap",controller:n,replace:!1,scope:{}}}t.module("dvhbSubwayMap").directive("subwayStationGroup",n)}(angular);